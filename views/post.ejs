<article class="article">
  <h1 class="article-title"><%= data.title %></h1>
  <div class="article-content" id="post-content"><%- data.body %></div>
</article>

<style>
  .article-content {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-family: inherit;
    line-height: 1.6;
    font-size: 1.1rem;
    color: #333;
  }

  .article-content p {
    margin-bottom: 1.5em;
  }

  .article-content a {
    color: #0a66c2;
    text-decoration: none;
    word-break: break-all; /* Added for long URLs */
  }

  .article-content a:hover {
    text-decoration: underline;
  }
</style>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    const contentDiv = document.getElementById('post-content');
    
    // First, preserve the original formatting by converting newlines to <br> and spaces to &nbsp;
    let html = contentDiv.innerHTML
      .replace(/\n/g, '<br>')
      .replace(/ /g, '&nbsp;');
    
    // Then convert URLs to links (including www. links without http)
    const urlRegex = /(\b(https?|ftp|file):\/\/[^\s<]+|\bwww\.[^\s<]+)/gi;
    html = html.replace(urlRegex, function(url) {
      const href = url.startsWith('www.') ? 'http://' + url : url;
      return `<a href="${href}" target="_blank" rel="noopener noreferrer">${url}</a>`;
    });
    
    // Update the content
    contentDiv.innerHTML = html;
    
    // Fix double &nbsp; replacements that might have happened in URLs
    const links = contentDiv.querySelectorAll('a');
    links.forEach(link => {
      link.innerHTML = link.innerHTML.replace(/&nbsp;/g, ' ');
    });
  });
</script>